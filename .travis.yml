language: shell
os: linux
dist: bionic

env:
  global:
    - LC_ALL: C.UTF-8
    - LANG: C.UTF-8

addons:
  snaps:
    - name: snapcraft
      channel: edge
      confinement: classic
    - name: multipass
      channel: stable
      confinement: classic

script:
  - snapcraft

after_failure:
  - sudo journalctl -u snapd

deploy:
  - provider: launchpad
    slug: "~ymshenyu/qv2ray/+git/trunk"
    oauth_token: $LAUNCHPAD_OAUTH_TOKEN
    oauth_token_secret: $LAUNCHPAD_OAUTH_TOKEN_SECRET
    on:
      all_branches: true